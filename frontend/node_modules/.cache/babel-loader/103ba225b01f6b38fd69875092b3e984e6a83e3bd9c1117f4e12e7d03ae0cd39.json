{"ast":null,"code":"var _jsxFileName = \"/Users/cyf/CursorProjects/riskAI/frontend/src/pages/AIAssistant.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Box, Typography, Paper, TextField, Button, List, ListItem, ListItemText, Chip, Avatar, CircularProgress, Divider, Alert } from '@mui/material';\nimport { Send as SendIcon, SmartToy as AIIcon, Person as UserIcon } from '@mui/icons-material';\nimport { featureApi } from '../services/api';\nimport { MockDataAlert } from '../components/MockDataAlert';\n\n// Sample suggestions for the user\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SUGGESTIONS = [\"What are the top 3 features by importance score?\", \"How do I interpret the Credit Utilization SQL query?\", \"Show me all features related to credit risk\", \"What parameters does the Suspicious Transactions query take?\", \"Explain the Income to Debt Ratio feature\"];\nexport default function AIAssistant() {\n  _s();\n  const [messages, setMessages] = useState([{\n    role: 'assistant',\n    content: 'Hello! I\\'m your Credit Risk AI Assistant. How can I help you today?'\n  }]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [features, setFeatures] = useState([]);\n  const [sqlStatements, setSqlStatements] = useState([]);\n  const [dataLoaded, setDataLoaded] = useState(false);\n  const [dataError, setDataError] = useState(null);\n  const [usingMockData, setUsingMockData] = useState(false);\n  const messagesEndRef = useRef(null);\n\n  // Safely parse JSON string to object with error handling\n  const safeJsonParse = str => {\n    try {\n      return typeof str === 'string' ? JSON.parse(str) : str;\n    } catch (e) {\n      console.error('Error parsing JSON:', e);\n      return null;\n    }\n  };\n\n  // Safely stringify object to JSON with error handling\n  const safeJsonStringify = obj => {\n    try {\n      return JSON.stringify(obj, null, 2);\n    } catch (e) {\n      console.error('Error stringifying JSON:', e);\n      return '{}';\n    }\n  };\n\n  // Load data when component mounts\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        setDataError(null);\n\n        // If there's an environment variable for using mock data, this will return true\n        const mockDataEnabled = process.env.REACT_APP_USE_MOCK_DATA === 'true' || true;\n        setUsingMockData(mockDataEnabled);\n\n        // Use Promise.allSettled for more resilient fetching\n        const results = await Promise.allSettled([featureApi.getFeatures(), featureApi.getSqlStatements()]);\n        if (results[0].status === 'fulfilled') {\n          // Check if data is not null and is iterable\n          if (results[0].value && Array.isArray(results[0].value)) {\n            setFeatures(results[0].value);\n          } else {\n            setFeatures([]);\n            console.error(\"Features data is not in expected format:\", results[0].value);\n          }\n        } else {\n          console.error(\"Error fetching features:\", results[0].reason);\n          setFeatures([]);\n        }\n        if (results[1].status === 'fulfilled') {\n          // Check if data is not null and is iterable\n          if (results[1].value && Array.isArray(results[1].value)) {\n            // Process SQL statements to ensure all required fields exist\n            const processedStatements = results[1].value.map(stmt => {\n              // Ensure statement has metadata property\n              if (!stmt.metadata) stmt.metadata = {};\n\n              // Ensure parameters exist\n              if (!stmt.metadata.parameters) stmt.metadata.parameters = [];\n\n              // Ensure statement property exists\n              if (!stmt.statement) stmt.statement = \"\";\n              return stmt;\n            });\n            setSqlStatements(processedStatements);\n          } else {\n            setSqlStatements([]);\n            console.error(\"SQL statements data is not in expected format:\", results[1].value);\n          }\n        } else {\n          console.error(\"Error fetching SQL statements:\", results[1].reason);\n          setSqlStatements([]);\n        }\n        setDataLoaded(true);\n      } catch (error) {\n        console.error(\"Error loading data for AI Assistant:\", error);\n        setDataError(\"Failed to load necessary data. Using fallback options.\");\n        // Still mark as loaded so the interface is usable\n        setDataLoaded(true);\n      } finally {\n        setLoading(false);\n      }\n    };\n    loadData();\n  }, []);\n\n  // Scroll to bottom whenever messages change\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n  const handleInputChange = e => {\n    setInput(e.target.value);\n  };\n  const handleSuggestionClick = suggestion => {\n    setInput(suggestion);\n  };\n  const handleSubmit = async () => {\n    if (!input.trim()) return;\n\n    // Add user message\n    const userMessage = {\n      role: 'user',\n      content: input\n    };\n    setMessages([...messages, userMessage]);\n    setInput('');\n    setLoading(true);\n\n    // Simulate AI thinking\n    await new Promise(resolve => setTimeout(resolve, 1000));\n\n    // Generate response based on the query\n    const response = generateResponse(input.trim());\n    setMessages(prev => [...prev, {\n      role: 'assistant',\n      content: response\n    }]);\n    setLoading(false);\n  };\n\n  // Function to generate responses based on user input\n  const generateResponse = query => {\n    const queryLower = query.toLowerCase();\n    try {\n      // Top features\n      if (queryLower.includes('top') && queryLower.includes('feature')) {\n        if (!features || features.length === 0) {\n          return \"I don't have any feature data available at the moment.\";\n        }\n        const sortedFeatures = [...features].filter(f => typeof f.importance_score === 'number').sort((a, b) => b.importance_score - a.importance_score);\n        const topN = queryLower.includes('3') ? 3 : queryLower.includes('5') ? 5 : 3;\n        const topFeatures = sortedFeatures.slice(0, topN);\n        if (topFeatures.length === 0) {\n          return \"I couldn't find features with valid importance scores.\";\n        }\n        return `The top ${topN} features by importance score are:\n${topFeatures.map((f, i) => `${i + 1}. ${f.name} (${f.importance_score})`).join('\\n')}`;\n      }\n\n      // Credit Utilization SQL\n      if (queryLower.includes('credit utilization') && queryLower.includes('sql')) {\n        const creditUtilizationQuery = sqlStatements.find(s => s.name === 'Credit Utilization');\n        if (creditUtilizationQuery && creditUtilizationQuery.statement) {\n          const statement = typeof creditUtilizationQuery.statement === 'object' ? safeJsonStringify(creditUtilizationQuery.statement) : creditUtilizationQuery.statement;\n          return `The Credit Utilization SQL query calculates what portion of available credit a customer is using. \n\nIt works by dividing the sum of balances by the sum of credit limits for all active accounts.\n\nHere's the query:\n\\`\\`\\`sql\n${statement}\n\\`\\`\\`\n\nThis query returns customers whose utilization ratio exceeds the threshold parameter (default is 0.7 or 70%).\nHigher utilization ratios generally indicate higher credit risk.`;\n        } else {\n          return \"I couldn't find the Credit Utilization SQL query in my data.\";\n        }\n      }\n\n      // Features related to credit risk\n      if (queryLower.includes('feature') && queryLower.includes('credit risk')) {\n        if (!features || features.length === 0) {\n          return \"I don't have any feature data available at the moment.\";\n        }\n        const creditRiskFeatures = features.filter(f => {\n          try {\n            return f.category === 'Credit Risk' || Array.isArray(f.tags) && f.tags.some(t => t && t.name && t.name.toLowerCase().includes('credit'));\n          } catch (e) {\n            return false;\n          }\n        });\n        if (creditRiskFeatures.length > 0) {\n          return `I found ${creditRiskFeatures.length} features related to credit risk:\n${creditRiskFeatures.map(f => `- ${f.name}: ${f.description || 'No description available'}`).join('\\n')}`;\n        } else {\n          return \"I couldn't find any features specifically categorized as Credit Risk.\";\n        }\n      }\n\n      // Suspicious Transactions parameters\n      if (queryLower.includes('suspicious transactions') && (queryLower.includes('parameter') || queryLower.includes('param'))) {\n        const suspiciousQuery = sqlStatements.find(s => s.name === 'Suspicious Transactions');\n        if (!suspiciousQuery) {\n          return \"I couldn't find the Suspicious Transactions query in my data.\";\n        }\n        const metadata = suspiciousQuery.metadata || {};\n        const params = metadata.parameters || [];\n        if (params.length > 0) {\n          return `The Suspicious Transactions query takes ${params.length} parameters:\n${params.map(p => `- ${p.name} (${p.type}): ${p.default_value || 'N/A'}${p.required ? ' (required)' : ''}`).join('\\n')}\n\nThis query identifies transactions that are much larger than a customer's average transaction amount, which could indicate fraudulent activity.`;\n        } else {\n          return \"The Suspicious Transactions query doesn't have any parameters defined.\";\n        }\n      }\n\n      // Explain Income to Debt Ratio\n      if (queryLower.includes('income to debt ratio') || queryLower.includes('debt') && queryLower.includes('ratio')) {\n        const feature = features.find(f => f.name === 'Income to Debt Ratio');\n        if (feature) {\n          return `The Income to Debt Ratio feature (importance score: ${feature.importance_score}) measures a customer's ability to manage debt.\n\nDescription: ${feature.description || 'No description available'}\nComputation: ${feature.computation_logic || 'No computation logic available'}\n\nThis ratio is critical for assessing affordability. Lower ratios indicate higher risk as more of the customer's income is going toward debt payments.`;\n        } else {\n          return \"I couldn't find the Income to Debt Ratio feature in my data.\";\n        }\n      }\n\n      // Default response if no specific match\n      return `Thank you for your question about \"${query}\". I'm currently running in demo mode with limited functionality. I can help with questions about features, SQL queries, and risk metrics. Try asking about top features, credit utilization, or specific SQL parameters.`;\n    } catch (error) {\n      console.error(\"Error generating response:\", error);\n      return `I apologize, but I encountered an error while processing your question about \"${query}\". This could be due to data format issues. Please try a different question or one of the suggested topics.`;\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h4\",\n      component: \"h1\",\n      gutterBottom: true,\n      children: \"AI Assistant\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }, this), usingMockData && /*#__PURE__*/_jsxDEV(MockDataAlert, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 25\n    }, this), dataError && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"warning\",\n      sx: {\n        mb: 2\n      },\n      children: dataError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        p: 2,\n        mb: 2,\n        height: '60vh',\n        display: 'flex',\n        flexDirection: 'column'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          flex: 1,\n          mb: 2,\n          overflowY: 'auto',\n          bgcolor: '#f9f9f9',\n          p: 2,\n          borderRadius: 1\n        },\n        children: [messages.map((message, index) => /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            mb: 2,\n            justifyContent: message.role === 'user' ? 'flex-end' : 'flex-start'\n          },\n          children: [message.role === 'assistant' && /*#__PURE__*/_jsxDEV(Avatar, {\n            sx: {\n              mr: 1,\n              bgcolor: 'primary.main'\n            },\n            children: /*#__PURE__*/_jsxDEV(AIIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 1,\n            sx: {\n              p: 2,\n              maxWidth: '70%',\n              bgcolor: message.role === 'user' ? 'primary.light' : 'white',\n              color: message.role === 'user' ? 'white' : 'text.primary'\n            },\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body1\",\n              sx: {\n                whiteSpace: 'pre-wrap'\n              },\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 15\n          }, this), message.role === 'user' && /*#__PURE__*/_jsxDEV(Avatar, {\n            sx: {\n              ml: 1,\n              bgcolor: 'secondary.main'\n            },\n            children: /*#__PURE__*/_jsxDEV(UserIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 13\n        }, this)), loading && /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            mb: 2,\n            justifyContent: 'flex-start'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Avatar, {\n            sx: {\n              mr: 1,\n              bgcolor: 'primary.main'\n            },\n            children: /*#__PURE__*/_jsxDEV(AIIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 1,\n            sx: {\n              p: 2,\n              bgcolor: 'white'\n            },\n            children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          mb: 2\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"subtitle2\",\n          gutterBottom: true,\n          children: \"Suggested questions:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: 1\n          },\n          children: SUGGESTIONS.map((suggestion, index) => /*#__PURE__*/_jsxDEV(Chip, {\n            label: suggestion,\n            onClick: () => handleSuggestionClick(suggestion),\n            variant: \"outlined\",\n            clickable: true\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {\n        sx: {\n          my: 2\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          display: 'flex',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          fullWidth: true,\n          variant: \"outlined\",\n          placeholder: \"Ask me anything about credit risk...\",\n          value: input,\n          onChange: handleInputChange,\n          onKeyPress: handleKeyPress,\n          disabled: loading || !dataLoaded,\n          multiline: true,\n          maxRows: 3,\n          sx: {\n            mr: 1\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          endIcon: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 22\n          }, this),\n          onClick: handleSubmit,\n          disabled: loading || !input.trim() || !dataLoaded,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 300,\n    columnNumber: 5\n  }, this);\n}\n_s(AIAssistant, \"tHDSO7ecXF5WxspqyZmv3y3cbNw=\");\n_c = AIAssistant;\nvar _c;\n$RefreshReg$(_c, \"AIAssistant\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Box","Typography","Paper","TextField","Button","List","ListItem","ListItemText","Chip","Avatar","CircularProgress","Divider","Alert","Send","SendIcon","SmartToy","AIIcon","Person","UserIcon","featureApi","MockDataAlert","jsxDEV","_jsxDEV","SUGGESTIONS","AIAssistant","_s","messages","setMessages","role","content","input","setInput","loading","setLoading","features","setFeatures","sqlStatements","setSqlStatements","dataLoaded","setDataLoaded","dataError","setDataError","usingMockData","setUsingMockData","messagesEndRef","safeJsonParse","str","JSON","parse","e","console","error","safeJsonStringify","obj","stringify","loadData","mockDataEnabled","process","env","REACT_APP_USE_MOCK_DATA","results","Promise","allSettled","getFeatures","getSqlStatements","status","value","Array","isArray","reason","processedStatements","map","stmt","metadata","parameters","statement","_messagesEndRef$curre","current","scrollIntoView","behavior","handleInputChange","target","handleSuggestionClick","suggestion","handleSubmit","trim","userMessage","resolve","setTimeout","response","generateResponse","prev","query","queryLower","toLowerCase","includes","length","sortedFeatures","filter","f","importance_score","sort","a","b","topN","topFeatures","slice","i","name","join","creditUtilizationQuery","find","s","creditRiskFeatures","category","tags","some","t","description","suspiciousQuery","params","p","type","default_value","required","feature","computation_logic","handleKeyPress","key","shiftKey","preventDefault","children","variant","component","gutterBottom","fileName","_jsxFileName","lineNumber","columnNumber","severity","sx","mb","height","display","flexDirection","flex","overflowY","bgcolor","borderRadius","message","index","justifyContent","mr","elevation","maxWidth","color","whiteSpace","ml","size","ref","flexWrap","gap","label","onClick","clickable","my","alignItems","fullWidth","placeholder","onChange","onKeyPress","disabled","multiline","maxRows","endIcon","_c","$RefreshReg$"],"sources":["/Users/cyf/CursorProjects/riskAI/frontend/src/pages/AIAssistant.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { \n  Box, \n  Typography, \n  Paper, \n  TextField, \n  Button, \n  List, \n  ListItem, \n  ListItemText, \n  Chip,\n  Avatar,\n  CircularProgress,\n  Divider,\n  Alert\n} from '@mui/material';\nimport { \n  Send as SendIcon,\n  SmartToy as AIIcon,\n  Person as UserIcon\n} from '@mui/icons-material';\nimport { featureApi } from '../services/api';\nimport { MockDataAlert } from '../components/MockDataAlert';\n\n// Sample suggestions for the user\nconst SUGGESTIONS = [\n  \"What are the top 3 features by importance score?\",\n  \"How do I interpret the Credit Utilization SQL query?\",\n  \"Show me all features related to credit risk\",\n  \"What parameters does the Suspicious Transactions query take?\",\n  \"Explain the Income to Debt Ratio feature\"\n];\n\nexport default function AIAssistant() {\n  const [messages, setMessages] = useState([\n    { \n      role: 'assistant', \n      content: 'Hello! I\\'m your Credit Risk AI Assistant. How can I help you today?' \n    }\n  ]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [features, setFeatures] = useState([]);\n  const [sqlStatements, setSqlStatements] = useState([]);\n  const [dataLoaded, setDataLoaded] = useState(false);\n  const [dataError, setDataError] = useState(null);\n  const [usingMockData, setUsingMockData] = useState(false);\n  \n  const messagesEndRef = useRef(null);\n\n  // Safely parse JSON string to object with error handling\n  const safeJsonParse = (str) => {\n    try {\n      return typeof str === 'string' ? JSON.parse(str) : str;\n    } catch (e) {\n      console.error('Error parsing JSON:', e);\n      return null;\n    }\n  };\n\n  // Safely stringify object to JSON with error handling\n  const safeJsonStringify = (obj) => {\n    try {\n      return JSON.stringify(obj, null, 2);\n    } catch (e) {\n      console.error('Error stringifying JSON:', e);\n      return '{}';\n    }\n  };\n\n  // Load data when component mounts\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        setDataError(null);\n        \n        // If there's an environment variable for using mock data, this will return true\n        const mockDataEnabled = process.env.REACT_APP_USE_MOCK_DATA === 'true' || true;\n        setUsingMockData(mockDataEnabled);\n        \n        // Use Promise.allSettled for more resilient fetching\n        const results = await Promise.allSettled([\n          featureApi.getFeatures(),\n          featureApi.getSqlStatements()\n        ]);\n        \n        if (results[0].status === 'fulfilled') {\n          // Check if data is not null and is iterable\n          if (results[0].value && Array.isArray(results[0].value)) {\n            setFeatures(results[0].value);\n          } else {\n            setFeatures([]);\n            console.error(\"Features data is not in expected format:\", results[0].value);\n          }\n        } else {\n          console.error(\"Error fetching features:\", results[0].reason);\n          setFeatures([]);\n        }\n        \n        if (results[1].status === 'fulfilled') {\n          // Check if data is not null and is iterable\n          if (results[1].value && Array.isArray(results[1].value)) {\n            // Process SQL statements to ensure all required fields exist\n            const processedStatements = results[1].value.map(stmt => {\n              // Ensure statement has metadata property\n              if (!stmt.metadata) stmt.metadata = {};\n              \n              // Ensure parameters exist\n              if (!stmt.metadata.parameters) stmt.metadata.parameters = [];\n              \n              // Ensure statement property exists\n              if (!stmt.statement) stmt.statement = \"\";\n              \n              return stmt;\n            });\n            setSqlStatements(processedStatements);\n          } else {\n            setSqlStatements([]);\n            console.error(\"SQL statements data is not in expected format:\", results[1].value);\n          }\n        } else {\n          console.error(\"Error fetching SQL statements:\", results[1].reason);\n          setSqlStatements([]);\n        }\n        \n        setDataLoaded(true);\n      } catch (error) {\n        console.error(\"Error loading data for AI Assistant:\", error);\n        setDataError(\"Failed to load necessary data. Using fallback options.\");\n        // Still mark as loaded so the interface is usable\n        setDataLoaded(true);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    loadData();\n  }, []);\n\n  // Scroll to bottom whenever messages change\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  const handleInputChange = (e) => {\n    setInput(e.target.value);\n  };\n\n  const handleSuggestionClick = (suggestion) => {\n    setInput(suggestion);\n  };\n\n  const handleSubmit = async () => {\n    if (!input.trim()) return;\n    \n    // Add user message\n    const userMessage = { role: 'user', content: input };\n    setMessages([...messages, userMessage]);\n    setInput('');\n    setLoading(true);\n    \n    // Simulate AI thinking\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    // Generate response based on the query\n    const response = generateResponse(input.trim());\n    setMessages(prev => [...prev, { role: 'assistant', content: response }]);\n    setLoading(false);\n  };\n\n  // Function to generate responses based on user input\n  const generateResponse = (query) => {\n    const queryLower = query.toLowerCase();\n    \n    try {\n      // Top features\n      if (queryLower.includes('top') && queryLower.includes('feature')) {\n        if (!features || features.length === 0) {\n          return \"I don't have any feature data available at the moment.\";\n        }\n        \n        const sortedFeatures = [...features]\n          .filter(f => typeof f.importance_score === 'number')\n          .sort((a, b) => b.importance_score - a.importance_score);\n          \n        const topN = queryLower.includes('3') ? 3 : (queryLower.includes('5') ? 5 : 3);\n        const topFeatures = sortedFeatures.slice(0, topN);\n        \n        if (topFeatures.length === 0) {\n          return \"I couldn't find features with valid importance scores.\";\n        }\n        \n        return `The top ${topN} features by importance score are:\n${topFeatures.map((f, i) => `${i + 1}. ${f.name} (${f.importance_score})`).join('\\n')}`;\n      }\n      \n      // Credit Utilization SQL\n      if (queryLower.includes('credit utilization') && queryLower.includes('sql')) {\n        const creditUtilizationQuery = sqlStatements.find(s => s.name === 'Credit Utilization');\n        if (creditUtilizationQuery && creditUtilizationQuery.statement) {\n          const statement = typeof creditUtilizationQuery.statement === 'object' \n            ? safeJsonStringify(creditUtilizationQuery.statement)\n            : creditUtilizationQuery.statement;\n            \n          return `The Credit Utilization SQL query calculates what portion of available credit a customer is using. \n\nIt works by dividing the sum of balances by the sum of credit limits for all active accounts.\n\nHere's the query:\n\\`\\`\\`sql\n${statement}\n\\`\\`\\`\n\nThis query returns customers whose utilization ratio exceeds the threshold parameter (default is 0.7 or 70%).\nHigher utilization ratios generally indicate higher credit risk.`;\n        } else {\n          return \"I couldn't find the Credit Utilization SQL query in my data.\";\n        }\n      }\n      \n      // Features related to credit risk\n      if (queryLower.includes('feature') && queryLower.includes('credit risk')) {\n        if (!features || features.length === 0) {\n          return \"I don't have any feature data available at the moment.\";\n        }\n        \n        const creditRiskFeatures = features.filter(f => {\n          try {\n            return (f.category === 'Credit Risk' || \n              (Array.isArray(f.tags) && f.tags.some(t => \n                t && t.name && t.name.toLowerCase().includes('credit')\n              ))\n            );\n          } catch (e) {\n            return false;\n          }\n        });\n        \n        if (creditRiskFeatures.length > 0) {\n          return `I found ${creditRiskFeatures.length} features related to credit risk:\n${creditRiskFeatures.map(f => `- ${f.name}: ${f.description || 'No description available'}`).join('\\n')}`;\n        } else {\n          return \"I couldn't find any features specifically categorized as Credit Risk.\";\n        }\n      }\n      \n      // Suspicious Transactions parameters\n      if (queryLower.includes('suspicious transactions') && (queryLower.includes('parameter') || queryLower.includes('param'))) {\n        const suspiciousQuery = sqlStatements.find(s => s.name === 'Suspicious Transactions');\n        \n        if (!suspiciousQuery) {\n          return \"I couldn't find the Suspicious Transactions query in my data.\";\n        }\n        \n        const metadata = suspiciousQuery.metadata || {};\n        const params = metadata.parameters || [];\n        \n        if (params.length > 0) {\n          return `The Suspicious Transactions query takes ${params.length} parameters:\n${params.map(p => `- ${p.name} (${p.type}): ${p.default_value || 'N/A'}${p.required ? ' (required)' : ''}`).join('\\n')}\n\nThis query identifies transactions that are much larger than a customer's average transaction amount, which could indicate fraudulent activity.`;\n        } else {\n          return \"The Suspicious Transactions query doesn't have any parameters defined.\";\n        }\n      }\n      \n      // Explain Income to Debt Ratio\n      if (queryLower.includes('income to debt ratio') || (queryLower.includes('debt') && queryLower.includes('ratio'))) {\n        const feature = features.find(f => f.name === 'Income to Debt Ratio');\n        if (feature) {\n          return `The Income to Debt Ratio feature (importance score: ${feature.importance_score}) measures a customer's ability to manage debt.\n\nDescription: ${feature.description || 'No description available'}\nComputation: ${feature.computation_logic || 'No computation logic available'}\n\nThis ratio is critical for assessing affordability. Lower ratios indicate higher risk as more of the customer's income is going toward debt payments.`;\n        } else {\n          return \"I couldn't find the Income to Debt Ratio feature in my data.\";\n        }\n      }\n      \n      // Default response if no specific match\n      return `Thank you for your question about \"${query}\". I'm currently running in demo mode with limited functionality. I can help with questions about features, SQL queries, and risk metrics. Try asking about top features, credit utilization, or specific SQL parameters.`;\n    } catch (error) {\n      console.error(\"Error generating response:\", error);\n      return `I apologize, but I encountered an error while processing your question about \"${query}\". This could be due to data format issues. Please try a different question or one of the suggested topics.`;\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit();\n    }\n  };\n\n  return (\n    <Box>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        AI Assistant\n      </Typography>\n      \n      {usingMockData && <MockDataAlert />}\n      \n      {dataError && (\n        <Alert severity=\"warning\" sx={{ mb: 2 }}>\n          {dataError}\n        </Alert>\n      )}\n      \n      <Paper sx={{ p: 2, mb: 2, height: '60vh', display: 'flex', flexDirection: 'column' }}>\n        {/* Message history */}\n        <Box \n          sx={{ \n            flex: 1, \n            mb: 2, \n            overflowY: 'auto',\n            bgcolor: '#f9f9f9',\n            p: 2,\n            borderRadius: 1\n          }}\n        >\n          {messages.map((message, index) => (\n            <Box \n              key={index} \n              sx={{ \n                display: 'flex', \n                mb: 2,\n                justifyContent: message.role === 'user' ? 'flex-end' : 'flex-start'\n              }}\n            >\n              {message.role === 'assistant' && (\n                <Avatar sx={{ mr: 1, bgcolor: 'primary.main' }}>\n                  <AIIcon />\n                </Avatar>\n              )}\n              <Paper \n                elevation={1} \n                sx={{ \n                  p: 2, \n                  maxWidth: '70%',\n                  bgcolor: message.role === 'user' ? 'primary.light' : 'white',\n                  color: message.role === 'user' ? 'white' : 'text.primary'\n                }}\n              >\n                <Typography \n                  variant=\"body1\" \n                  sx={{ \n                    whiteSpace: 'pre-wrap' \n                  }}\n                >\n                  {message.content}\n                </Typography>\n              </Paper>\n              {message.role === 'user' && (\n                <Avatar sx={{ ml: 1, bgcolor: 'secondary.main' }}>\n                  <UserIcon />\n                </Avatar>\n              )}\n            </Box>\n          ))}\n          {loading && (\n            <Box \n              sx={{ \n                display: 'flex', \n                mb: 2,\n                justifyContent: 'flex-start'\n              }}\n            >\n              <Avatar sx={{ mr: 1, bgcolor: 'primary.main' }}>\n                <AIIcon />\n              </Avatar>\n              <Paper \n                elevation={1} \n                sx={{ \n                  p: 2, \n                  bgcolor: 'white',\n                }}\n              >\n                <CircularProgress size={20} />\n              </Paper>\n            </Box>\n          )}\n          <div ref={messagesEndRef} />\n        </Box>\n        \n        {/* Suggested questions */}\n        <Box sx={{ mb: 2 }}>\n          <Typography variant=\"subtitle2\" gutterBottom>\n            Suggested questions:\n          </Typography>\n          <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1 }}>\n            {SUGGESTIONS.map((suggestion, index) => (\n              <Chip \n                key={index} \n                label={suggestion} \n                onClick={() => handleSuggestionClick(suggestion)}\n                variant=\"outlined\"\n                clickable\n              />\n            ))}\n          </Box>\n        </Box>\n        \n        <Divider sx={{ my: 2 }} />\n        \n        {/* Input area */}\n        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n          <TextField\n            fullWidth\n            variant=\"outlined\"\n            placeholder=\"Ask me anything about credit risk...\"\n            value={input}\n            onChange={handleInputChange}\n            onKeyPress={handleKeyPress}\n            disabled={loading || !dataLoaded}\n            multiline\n            maxRows={3}\n            sx={{ mr: 1 }}\n          />\n          <Button \n            variant=\"contained\" \n            color=\"primary\" \n            endIcon={<SendIcon />}\n            onClick={handleSubmit}\n            disabled={loading || !input.trim() || !dataLoaded}\n          >\n            Send\n          </Button>\n        </Box>\n      </Paper>\n    </Box>\n  );\n} "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAC1D,SACEC,GAAG,EACHC,UAAU,EACVC,KAAK,EACLC,SAAS,EACTC,MAAM,EACNC,IAAI,EACJC,QAAQ,EACRC,YAAY,EACZC,IAAI,EACJC,MAAM,EACNC,gBAAgB,EAChBC,OAAO,EACPC,KAAK,QACA,eAAe;AACtB,SACEC,IAAI,IAAIC,QAAQ,EAChBC,QAAQ,IAAIC,MAAM,EAClBC,MAAM,IAAIC,QAAQ,QACb,qBAAqB;AAC5B,SAASC,UAAU,QAAQ,iBAAiB;AAC5C,SAASC,aAAa,QAAQ,6BAA6B;;AAE3D;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,WAAW,GAAG,CAClB,kDAAkD,EAClD,sDAAsD,EACtD,6CAA6C,EAC7C,8DAA8D,EAC9D,0CAA0C,CAC3C;AAED,eAAe,SAASC,WAAWA,CAAA,EAAG;EAAAC,EAAA;EACpC,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAG9B,QAAQ,CAAC,CACvC;IACE+B,IAAI,EAAE,WAAW;IACjBC,OAAO,EAAE;EACX,CAAC,CACF,CAAC;EACF,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGlC,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACmC,OAAO,EAAEC,UAAU,CAAC,GAAGpC,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACqC,QAAQ,EAAEC,WAAW,CAAC,GAAGtC,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACuC,aAAa,EAAEC,gBAAgB,CAAC,GAAGxC,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACyC,UAAU,EAAEC,aAAa,CAAC,GAAG1C,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAAC2C,SAAS,EAAEC,YAAY,CAAC,GAAG5C,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAAC6C,aAAa,EAAEC,gBAAgB,CAAC,GAAG9C,QAAQ,CAAC,KAAK,CAAC;EAEzD,MAAM+C,cAAc,GAAG9C,MAAM,CAAC,IAAI,CAAC;;EAEnC;EACA,MAAM+C,aAAa,GAAIC,GAAG,IAAK;IAC7B,IAAI;MACF,OAAO,OAAOA,GAAG,KAAK,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACF,GAAG,CAAC,GAAGA,GAAG;IACxD,CAAC,CAAC,OAAOG,CAAC,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,qBAAqB,EAAEF,CAAC,CAAC;MACvC,OAAO,IAAI;IACb;EACF,CAAC;;EAED;EACA,MAAMG,iBAAiB,GAAIC,GAAG,IAAK;IACjC,IAAI;MACF,OAAON,IAAI,CAACO,SAAS,CAACD,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;IACrC,CAAC,CAAC,OAAOJ,CAAC,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEF,CAAC,CAAC;MAC5C,OAAO,IAAI;IACb;EACF,CAAC;;EAED;EACAlD,SAAS,CAAC,MAAM;IACd,MAAMwD,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3B,IAAI;QACFtB,UAAU,CAAC,IAAI,CAAC;QAChBQ,YAAY,CAAC,IAAI,CAAC;;QAElB;QACA,MAAMe,eAAe,GAAGC,OAAO,CAACC,GAAG,CAACC,uBAAuB,KAAK,MAAM,IAAI,IAAI;QAC9EhB,gBAAgB,CAACa,eAAe,CAAC;;QAEjC;QACA,MAAMI,OAAO,GAAG,MAAMC,OAAO,CAACC,UAAU,CAAC,CACvC3C,UAAU,CAAC4C,WAAW,CAAC,CAAC,EACxB5C,UAAU,CAAC6C,gBAAgB,CAAC,CAAC,CAC9B,CAAC;QAEF,IAAIJ,OAAO,CAAC,CAAC,CAAC,CAACK,MAAM,KAAK,WAAW,EAAE;UACrC;UACA,IAAIL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,IAAIC,KAAK,CAACC,OAAO,CAACR,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,EAAE;YACvD/B,WAAW,CAACyB,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;UAC/B,CAAC,MAAM;YACL/B,WAAW,CAAC,EAAE,CAAC;YACfe,OAAO,CAACC,KAAK,CAAC,0CAA0C,EAAES,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;UAC7E;QACF,CAAC,MAAM;UACLhB,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAES,OAAO,CAAC,CAAC,CAAC,CAACS,MAAM,CAAC;UAC5DlC,WAAW,CAAC,EAAE,CAAC;QACjB;QAEA,IAAIyB,OAAO,CAAC,CAAC,CAAC,CAACK,MAAM,KAAK,WAAW,EAAE;UACrC;UACA,IAAIL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,IAAIC,KAAK,CAACC,OAAO,CAACR,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,EAAE;YACvD;YACA,MAAMI,mBAAmB,GAAGV,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAACK,GAAG,CAACC,IAAI,IAAI;cACvD;cACA,IAAI,CAACA,IAAI,CAACC,QAAQ,EAAED,IAAI,CAACC,QAAQ,GAAG,CAAC,CAAC;;cAEtC;cACA,IAAI,CAACD,IAAI,CAACC,QAAQ,CAACC,UAAU,EAAEF,IAAI,CAACC,QAAQ,CAACC,UAAU,GAAG,EAAE;;cAE5D;cACA,IAAI,CAACF,IAAI,CAACG,SAAS,EAAEH,IAAI,CAACG,SAAS,GAAG,EAAE;cAExC,OAAOH,IAAI;YACb,CAAC,CAAC;YACFnC,gBAAgB,CAACiC,mBAAmB,CAAC;UACvC,CAAC,MAAM;YACLjC,gBAAgB,CAAC,EAAE,CAAC;YACpBa,OAAO,CAACC,KAAK,CAAC,gDAAgD,EAAES,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;UACnF;QACF,CAAC,MAAM;UACLhB,OAAO,CAACC,KAAK,CAAC,gCAAgC,EAAES,OAAO,CAAC,CAAC,CAAC,CAACS,MAAM,CAAC;UAClEhC,gBAAgB,CAAC,EAAE,CAAC;QACtB;QAEAE,aAAa,CAAC,IAAI,CAAC;MACrB,CAAC,CAAC,OAAOY,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;QAC5DV,YAAY,CAAC,wDAAwD,CAAC;QACtE;QACAF,aAAa,CAAC,IAAI,CAAC;MACrB,CAAC,SAAS;QACRN,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC;IAEDsB,QAAQ,CAAC,CAAC;EACZ,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAxD,SAAS,CAAC,MAAM;IAAA,IAAA6E,qBAAA;IACd,CAAAA,qBAAA,GAAAhC,cAAc,CAACiC,OAAO,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwBE,cAAc,CAAC;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EAChE,CAAC,EAAE,CAACrD,QAAQ,CAAC,CAAC;EAEd,MAAMsD,iBAAiB,GAAI/B,CAAC,IAAK;IAC/BlB,QAAQ,CAACkB,CAAC,CAACgC,MAAM,CAACf,KAAK,CAAC;EAC1B,CAAC;EAED,MAAMgB,qBAAqB,GAAIC,UAAU,IAAK;IAC5CpD,QAAQ,CAACoD,UAAU,CAAC;EACtB,CAAC;EAED,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,IAAI,CAACtD,KAAK,CAACuD,IAAI,CAAC,CAAC,EAAE;;IAEnB;IACA,MAAMC,WAAW,GAAG;MAAE1D,IAAI,EAAE,MAAM;MAAEC,OAAO,EAAEC;IAAM,CAAC;IACpDH,WAAW,CAAC,CAAC,GAAGD,QAAQ,EAAE4D,WAAW,CAAC,CAAC;IACvCvD,QAAQ,CAAC,EAAE,CAAC;IACZE,UAAU,CAAC,IAAI,CAAC;;IAEhB;IACA,MAAM,IAAI4B,OAAO,CAAC0B,OAAO,IAAIC,UAAU,CAACD,OAAO,EAAE,IAAI,CAAC,CAAC;;IAEvD;IACA,MAAME,QAAQ,GAAGC,gBAAgB,CAAC5D,KAAK,CAACuD,IAAI,CAAC,CAAC,CAAC;IAC/C1D,WAAW,CAACgE,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE;MAAE/D,IAAI,EAAE,WAAW;MAAEC,OAAO,EAAE4D;IAAS,CAAC,CAAC,CAAC;IACxExD,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC;;EAED;EACA,MAAMyD,gBAAgB,GAAIE,KAAK,IAAK;IAClC,MAAMC,UAAU,GAAGD,KAAK,CAACE,WAAW,CAAC,CAAC;IAEtC,IAAI;MACF;MACA,IAAID,UAAU,CAACE,QAAQ,CAAC,KAAK,CAAC,IAAIF,UAAU,CAACE,QAAQ,CAAC,SAAS,CAAC,EAAE;QAChE,IAAI,CAAC7D,QAAQ,IAAIA,QAAQ,CAAC8D,MAAM,KAAK,CAAC,EAAE;UACtC,OAAO,wDAAwD;QACjE;QAEA,MAAMC,cAAc,GAAG,CAAC,GAAG/D,QAAQ,CAAC,CACjCgE,MAAM,CAACC,CAAC,IAAI,OAAOA,CAAC,CAACC,gBAAgB,KAAK,QAAQ,CAAC,CACnDC,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACH,gBAAgB,GAAGE,CAAC,CAACF,gBAAgB,CAAC;QAE1D,MAAMI,IAAI,GAAGX,UAAU,CAACE,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,GAAIF,UAAU,CAACE,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAE;QAC9E,MAAMU,WAAW,GAAGR,cAAc,CAACS,KAAK,CAAC,CAAC,EAAEF,IAAI,CAAC;QAEjD,IAAIC,WAAW,CAACT,MAAM,KAAK,CAAC,EAAE;UAC5B,OAAO,wDAAwD;QACjE;QAEA,OAAO,WAAWQ,IAAI;AAC9B,EAAEC,WAAW,CAAClC,GAAG,CAAC,CAAC4B,CAAC,EAAEQ,CAAC,KAAK,GAAGA,CAAC,GAAG,CAAC,KAAKR,CAAC,CAACS,IAAI,KAAKT,CAAC,CAACC,gBAAgB,GAAG,CAAC,CAACS,IAAI,CAAC,IAAI,CAAC,EAAE;MACjF;;MAEA;MACA,IAAIhB,UAAU,CAACE,QAAQ,CAAC,oBAAoB,CAAC,IAAIF,UAAU,CAACE,QAAQ,CAAC,KAAK,CAAC,EAAE;QAC3E,MAAMe,sBAAsB,GAAG1E,aAAa,CAAC2E,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACJ,IAAI,KAAK,oBAAoB,CAAC;QACvF,IAAIE,sBAAsB,IAAIA,sBAAsB,CAACnC,SAAS,EAAE;UAC9D,MAAMA,SAAS,GAAG,OAAOmC,sBAAsB,CAACnC,SAAS,KAAK,QAAQ,GAClEvB,iBAAiB,CAAC0D,sBAAsB,CAACnC,SAAS,CAAC,GACnDmC,sBAAsB,CAACnC,SAAS;UAEpC,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA,EAAEA,SAAS;AACX;AACA;AACA;AACA,iEAAiE;QACzD,CAAC,MAAM;UACL,OAAO,8DAA8D;QACvE;MACF;;MAEA;MACA,IAAIkB,UAAU,CAACE,QAAQ,CAAC,SAAS,CAAC,IAAIF,UAAU,CAACE,QAAQ,CAAC,aAAa,CAAC,EAAE;QACxE,IAAI,CAAC7D,QAAQ,IAAIA,QAAQ,CAAC8D,MAAM,KAAK,CAAC,EAAE;UACtC,OAAO,wDAAwD;QACjE;QAEA,MAAMiB,kBAAkB,GAAG/E,QAAQ,CAACgE,MAAM,CAACC,CAAC,IAAI;UAC9C,IAAI;YACF,OAAQA,CAAC,CAACe,QAAQ,KAAK,aAAa,IACjC/C,KAAK,CAACC,OAAO,CAAC+B,CAAC,CAACgB,IAAI,CAAC,IAAIhB,CAAC,CAACgB,IAAI,CAACC,IAAI,CAACC,CAAC,IACrCA,CAAC,IAAIA,CAAC,CAACT,IAAI,IAAIS,CAAC,CAACT,IAAI,CAACd,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,QAAQ,CACvD,CAAE;UAEN,CAAC,CAAC,OAAO9C,CAAC,EAAE;YACV,OAAO,KAAK;UACd;QACF,CAAC,CAAC;QAEF,IAAIgE,kBAAkB,CAACjB,MAAM,GAAG,CAAC,EAAE;UACjC,OAAO,WAAWiB,kBAAkB,CAACjB,MAAM;AACrD,EAAEiB,kBAAkB,CAAC1C,GAAG,CAAC4B,CAAC,IAAI,KAAKA,CAAC,CAACS,IAAI,KAAKT,CAAC,CAACmB,WAAW,IAAI,0BAA0B,EAAE,CAAC,CAACT,IAAI,CAAC,IAAI,CAAC,EAAE;QACjG,CAAC,MAAM;UACL,OAAO,uEAAuE;QAChF;MACF;;MAEA;MACA,IAAIhB,UAAU,CAACE,QAAQ,CAAC,yBAAyB,CAAC,KAAKF,UAAU,CAACE,QAAQ,CAAC,WAAW,CAAC,IAAIF,UAAU,CAACE,QAAQ,CAAC,OAAO,CAAC,CAAC,EAAE;QACxH,MAAMwB,eAAe,GAAGnF,aAAa,CAAC2E,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACJ,IAAI,KAAK,yBAAyB,CAAC;QAErF,IAAI,CAACW,eAAe,EAAE;UACpB,OAAO,+DAA+D;QACxE;QAEA,MAAM9C,QAAQ,GAAG8C,eAAe,CAAC9C,QAAQ,IAAI,CAAC,CAAC;QAC/C,MAAM+C,MAAM,GAAG/C,QAAQ,CAACC,UAAU,IAAI,EAAE;QAExC,IAAI8C,MAAM,CAACxB,MAAM,GAAG,CAAC,EAAE;UACrB,OAAO,2CAA2CwB,MAAM,CAACxB,MAAM;AACzE,EAAEwB,MAAM,CAACjD,GAAG,CAACkD,CAAC,IAAI,KAAKA,CAAC,CAACb,IAAI,KAAKa,CAAC,CAACC,IAAI,MAAMD,CAAC,CAACE,aAAa,IAAI,KAAK,GAAGF,CAAC,CAACG,QAAQ,GAAG,aAAa,GAAG,EAAE,EAAE,CAAC,CAACf,IAAI,CAAC,IAAI,CAAC;AACtH;AACA,gJAAgJ;QACxI,CAAC,MAAM;UACL,OAAO,wEAAwE;QACjF;MACF;;MAEA;MACA,IAAIhB,UAAU,CAACE,QAAQ,CAAC,sBAAsB,CAAC,IAAKF,UAAU,CAACE,QAAQ,CAAC,MAAM,CAAC,IAAIF,UAAU,CAACE,QAAQ,CAAC,OAAO,CAAE,EAAE;QAChH,MAAM8B,OAAO,GAAG3F,QAAQ,CAAC6E,IAAI,CAACZ,CAAC,IAAIA,CAAC,CAACS,IAAI,KAAK,sBAAsB,CAAC;QACrE,IAAIiB,OAAO,EAAE;UACX,OAAO,uDAAuDA,OAAO,CAACzB,gBAAgB;AAChG;AACA,eAAeyB,OAAO,CAACP,WAAW,IAAI,0BAA0B;AAChE,eAAeO,OAAO,CAACC,iBAAiB,IAAI,gCAAgC;AAC5E;AACA,sJAAsJ;QAC9I,CAAC,MAAM;UACL,OAAO,8DAA8D;QACvE;MACF;;MAEA;MACA,OAAO,sCAAsClC,KAAK,2NAA2N;IAC/Q,CAAC,CAAC,OAAOzC,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClD,OAAO,iFAAiFyC,KAAK,6GAA6G;IAC5M;EACF,CAAC;EAED,MAAMmC,cAAc,GAAI9E,CAAC,IAAK;IAC5B,IAAIA,CAAC,CAAC+E,GAAG,KAAK,OAAO,IAAI,CAAC/E,CAAC,CAACgF,QAAQ,EAAE;MACpChF,CAAC,CAACiF,cAAc,CAAC,CAAC;MAClB9C,YAAY,CAAC,CAAC;IAChB;EACF,CAAC;EAED,oBACE9D,OAAA,CAACtB,GAAG;IAAAmI,QAAA,gBACF7G,OAAA,CAACrB,UAAU;MAACmI,OAAO,EAAC,IAAI;MAACC,SAAS,EAAC,IAAI;MAACC,YAAY;MAAAH,QAAA,EAAC;IAErD;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAY,CAAC,EAEZhG,aAAa,iBAAIpB,OAAA,CAACF,aAAa;MAAAmH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,EAElClG,SAAS,iBACRlB,OAAA,CAACV,KAAK;MAAC+H,QAAQ,EAAC,SAAS;MAACC,EAAE,EAAE;QAAEC,EAAE,EAAE;MAAE,CAAE;MAAAV,QAAA,EACrC3F;IAAS;MAAA+F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CACR,eAEDpH,OAAA,CAACpB,KAAK;MAAC0I,EAAE,EAAE;QAAEnB,CAAC,EAAE,CAAC;QAAEoB,EAAE,EAAE,CAAC;QAAEC,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE,MAAM;QAAEC,aAAa,EAAE;MAAS,CAAE;MAAAb,QAAA,gBAEnF7G,OAAA,CAACtB,GAAG;QACF4I,EAAE,EAAE;UACFK,IAAI,EAAE,CAAC;UACPJ,EAAE,EAAE,CAAC;UACLK,SAAS,EAAE,MAAM;UACjBC,OAAO,EAAE,SAAS;UAClB1B,CAAC,EAAE,CAAC;UACJ2B,YAAY,EAAE;QAChB,CAAE;QAAAjB,QAAA,GAEDzG,QAAQ,CAAC6C,GAAG,CAAC,CAAC8E,OAAO,EAAEC,KAAK,kBAC3BhI,OAAA,CAACtB,GAAG;UAEF4I,EAAE,EAAE;YACFG,OAAO,EAAE,MAAM;YACfF,EAAE,EAAE,CAAC;YACLU,cAAc,EAAEF,OAAO,CAACzH,IAAI,KAAK,MAAM,GAAG,UAAU,GAAG;UACzD,CAAE;UAAAuG,QAAA,GAEDkB,OAAO,CAACzH,IAAI,KAAK,WAAW,iBAC3BN,OAAA,CAACb,MAAM;YAACmI,EAAE,EAAE;cAAEY,EAAE,EAAE,CAAC;cAAEL,OAAO,EAAE;YAAe,CAAE;YAAAhB,QAAA,eAC7C7G,OAAA,CAACN,MAAM;cAAAuH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CACT,eACDpH,OAAA,CAACpB,KAAK;YACJuJ,SAAS,EAAE,CAAE;YACbb,EAAE,EAAE;cACFnB,CAAC,EAAE,CAAC;cACJiC,QAAQ,EAAE,KAAK;cACfP,OAAO,EAAEE,OAAO,CAACzH,IAAI,KAAK,MAAM,GAAG,eAAe,GAAG,OAAO;cAC5D+H,KAAK,EAAEN,OAAO,CAACzH,IAAI,KAAK,MAAM,GAAG,OAAO,GAAG;YAC7C,CAAE;YAAAuG,QAAA,eAEF7G,OAAA,CAACrB,UAAU;cACTmI,OAAO,EAAC,OAAO;cACfQ,EAAE,EAAE;gBACFgB,UAAU,EAAE;cACd,CAAE;cAAAzB,QAAA,EAEDkB,OAAO,CAACxH;YAAO;cAAA0G,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACR,CAAC,EACPW,OAAO,CAACzH,IAAI,KAAK,MAAM,iBACtBN,OAAA,CAACb,MAAM;YAACmI,EAAE,EAAE;cAAEiB,EAAE,EAAE,CAAC;cAAEV,OAAO,EAAE;YAAiB,CAAE;YAAAhB,QAAA,eAC/C7G,OAAA,CAACJ,QAAQ;cAAAqH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CACT;QAAA,GAlCIY,KAAK;UAAAf,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAmCP,CACN,CAAC,EACD1G,OAAO,iBACNV,OAAA,CAACtB,GAAG;UACF4I,EAAE,EAAE;YACFG,OAAO,EAAE,MAAM;YACfF,EAAE,EAAE,CAAC;YACLU,cAAc,EAAE;UAClB,CAAE;UAAApB,QAAA,gBAEF7G,OAAA,CAACb,MAAM;YAACmI,EAAE,EAAE;cAAEY,EAAE,EAAE,CAAC;cAAEL,OAAO,EAAE;YAAe,CAAE;YAAAhB,QAAA,eAC7C7G,OAAA,CAACN,MAAM;cAAAuH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC,eACTpH,OAAA,CAACpB,KAAK;YACJuJ,SAAS,EAAE,CAAE;YACbb,EAAE,EAAE;cACFnB,CAAC,EAAE,CAAC;cACJ0B,OAAO,EAAE;YACX,CAAE;YAAAhB,QAAA,eAEF7G,OAAA,CAACZ,gBAAgB;cAACoJ,IAAI,EAAE;YAAG;cAAAvB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CACN,eACDpH,OAAA;UAAKyI,GAAG,EAAEnH;QAAe;UAAA2F,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzB,CAAC,eAGNpH,OAAA,CAACtB,GAAG;QAAC4I,EAAE,EAAE;UAAEC,EAAE,EAAE;QAAE,CAAE;QAAAV,QAAA,gBACjB7G,OAAA,CAACrB,UAAU;UAACmI,OAAO,EAAC,WAAW;UAACE,YAAY;UAAAH,QAAA,EAAC;QAE7C;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAY,CAAC,eACbpH,OAAA,CAACtB,GAAG;UAAC4I,EAAE,EAAE;YAAEG,OAAO,EAAE,MAAM;YAAEiB,QAAQ,EAAE,MAAM;YAAEC,GAAG,EAAE;UAAE,CAAE;UAAA9B,QAAA,EACpD5G,WAAW,CAACgD,GAAG,CAAC,CAACY,UAAU,EAAEmE,KAAK,kBACjChI,OAAA,CAACd,IAAI;YAEH0J,KAAK,EAAE/E,UAAW;YAClBgF,OAAO,EAAEA,CAAA,KAAMjF,qBAAqB,CAACC,UAAU,CAAE;YACjDiD,OAAO,EAAC,UAAU;YAClBgC,SAAS;UAAA,GAJJd,KAAK;YAAAf,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAKX,CACF;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAENpH,OAAA,CAACX,OAAO;QAACiI,EAAE,EAAE;UAAEyB,EAAE,EAAE;QAAE;MAAE;QAAA9B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAG1BpH,OAAA,CAACtB,GAAG;QAAC4I,EAAE,EAAE;UAAEG,OAAO,EAAE,MAAM;UAAEuB,UAAU,EAAE;QAAS,CAAE;QAAAnC,QAAA,gBACjD7G,OAAA,CAACnB,SAAS;UACRoK,SAAS;UACTnC,OAAO,EAAC,UAAU;UAClBoC,WAAW,EAAC,sCAAsC;UAClDtG,KAAK,EAAEpC,KAAM;UACb2I,QAAQ,EAAEzF,iBAAkB;UAC5B0F,UAAU,EAAE3C,cAAe;UAC3B4C,QAAQ,EAAE3I,OAAO,IAAI,CAACM,UAAW;UACjCsI,SAAS;UACTC,OAAO,EAAE,CAAE;UACXjC,EAAE,EAAE;YAAEY,EAAE,EAAE;UAAE;QAAE;UAAAjB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACf,CAAC,eACFpH,OAAA,CAAClB,MAAM;UACLgI,OAAO,EAAC,WAAW;UACnBuB,KAAK,EAAC,SAAS;UACfmB,OAAO,eAAExJ,OAAA,CAACR,QAAQ;YAAAyH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAE;UACtByB,OAAO,EAAE/E,YAAa;UACtBuF,QAAQ,EAAE3I,OAAO,IAAI,CAACF,KAAK,CAACuD,IAAI,CAAC,CAAC,IAAI,CAAC/C,UAAW;UAAA6F,QAAA,EACnD;QAED;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEV;AAACjH,EAAA,CAlZuBD,WAAW;AAAAuJ,EAAA,GAAXvJ,WAAW;AAAA,IAAAuJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}